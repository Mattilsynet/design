@layer mt.design {
	.steps {
		--mtdsc-steps-dot-size: var(--ds-size-7);
		--mtdsc-steps-gap: var(--ds-size-4);
		--mtdsc-steps-stroke-color: var(--ds-color-border-subtle);
		--mtdsc-steps-stroke-size: 2px;

		display: flex;
		list-style: none;
		margin: 0;
		padding: 0;
		text-align: center;
	}
	.steps > * {
		--dot-after: var(--mtdsc-steps-stroke-color);
		--dot-before: var(--mtdsc-steps-stroke-color);
		--dot-text: initial;
		--dot-fill: initial;
		--dot-icon: linear-gradient(transparent);

		border-radius: var(--ds-border-radius-md);
		box-sizing: border-box;
		flex: 1;
		padding-top: calc(var(--mtdsc-steps-dot-size) + var(--mtdsc-steps-gap));
		position: relative;
		text-decoration: none;
	}

	/*
	 * Line
	 */
	.steps > ::before,
	.steps > ::after {
		background: linear-gradient(to right, transparent, var(--dot-before));
		content: "";
		height: var(--mtdsc-steps-stroke-size);
		inset: 0 50% auto -50%;
		margin: calc(var(--mtdsc-steps-dot-size) / 2);
		position: absolute;
		translate: 0 -50%;
	}
	.steps > ::after {
		background: linear-gradient(to right, var(--dot-after), transparent);
		inset-inline: 50% -50%;
	}
	.steps > :first-child::before {
		left: 0;
	}
	.steps > :last-child::after {
		right: 0;
	}

	/*
	 * Dot
	 */
	.steps > * > mark {
		background: var(--dot-fill);
		border-radius: var(--ds-border-radius-full);
		border: var(--mtdsc-steps-stroke-size) solid
			var(--dot-fill, var(--mtdsc-steps-stroke-color));
		box-sizing: border-box;
		color: var(--dot-text); /* Let it be affected by data-color */
		height: var(--mtdsc-steps-dot-size);
		display: grid;
		place-items: center;
		inset: 0 0 auto;
		margin-inline: auto;
		position: absolute;
		transition: .2s scale;
		width: var(--mtdsc-steps-dot-size);
		z-index: 2; /* Place above line */
	}
	.steps > * > mark > svg,
	.steps > * > mark:empty::before {
		width: 75%;
		height: 75%;
	}
	.steps > * > mark:empty::before {
		background: currentColor;
		content: "";
		mask: var(--dot-icon) center / contain no-repeat;
	}
	.steps > :is(a, button, [role="button"]):hover:not(:active) > mark {
		scale: 1.175;
	}

	/*
	 * States
	 */
	.steps:not([data-direction="up"]) > [aria-current="step"],
	.steps:not([data-direction="up"]) > :has(~ [aria-current="step"]),
	.steps[data-direction="up"] > [aria-current="step"] ~ * {
		--dot-before: var(--dot-fill);
	}
	.steps:not([data-direction="up"]) > :has(~ [aria-current="step"]),
	.steps[data-direction="up"] > [aria-current="step"] ~ *,
	.steps[data-direction="up"] > [aria-current="step"] {
		--dot-after: var(--dot-fill);
	}
	.steps > [aria-current="step"] > mark {
		box-shadow: 0 0 0 var(--mtdsc-steps-stroke-size) var(--dot-text), 0 0 0
			calc(var(--mtdsc-steps-stroke-size) * 2) var(--dot-fill);
	}
	.steps:not([data-direction="up"]) > :where(:has(~ [aria-current="step"])),
	.steps[data-direction="up"] > :where([aria-current="step"] ~ *) {
		--dot-icon: var(--mtds-icon-check);
	}
	.steps > [aria-current="step"],
	.steps[data-direction="up"] > [aria-current="step"] ~ *,
	.steps:not([data-direction="up"]) > :has(~ [aria-current="step"]),
	.steps > [data-color] {
		--dot-text: var(--ds-color-base-contrast-default);
		--dot-fill: var(--ds-color-base-default);
	}
	.steps > [data-color="danger"],
	.steps > [data-color="warning"] {
		--dot-icon: var(--mtds-icon-close);
	}

	/*
	 * Fade
	 */
	.steps:is(
			:not([data-fade]),
			[data-fade="false"],
			[data-fade="end"]:not([data-direction="up"]),
			[data-fade="start"][data-direction="up"]
		)
		> :first-child::before {
		display: none;
	}
	.steps:is(
			:not([data-fade]),
			[data-fade="false"],
			[data-fade="start"]:not([data-direction="up"]),
			[data-fade="end"][data-direction="up"]
		)
		> :last-child::after {
		display: none;
	}

	/*
	 * Vertical
	 */
	.steps[data-direction]:not([data-direction="right"]) {
		flex-wrap: wrap;
		text-align: left;
	}
	.steps[data-direction]:not([data-direction="right"]) > * {
		flex: 1 0 100%;
		min-height: calc(var(--mtdsc-steps-dot-size) * 2);
		padding-block: 0 var(--mtdsc-steps-dot-size);
		padding-left: calc(var(--mtdsc-steps-dot-size) + var(--mtdsc-steps-gap));
	}
	.steps[data-direction]:not([data-direction="right"]) > * > mark {
		margin: 0;
	}
	.steps[data-direction]:not([data-direction="right"]) > ::before,
	.steps[data-direction]:not([data-direction="right"]) > ::after {
		background: linear-gradient(transparent, var(--dot-before));
		height: auto;
		margin-block: 0;
		width: var(--mtdsc-steps-stroke-size);
		inset: calc(var(--mtdsc-steps-dot-size) * -1) 0 100%;
		translate: -50%;
	}
	.steps[data-direction]:not([data-direction="right"]) > ::after {
		background: linear-gradient(
			var(--dot-after),
			var(--dot-after-end, var(--dot-after))
		);
		inset-block: var(--mtdsc-steps-dot-size) 0;
	}
	.steps[data-direction]:not([data-direction="right"]) > :last-child::after {
		--dot-after-end: transparent;
	}
}
