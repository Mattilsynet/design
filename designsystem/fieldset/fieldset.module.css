@layer mt.design {
	.fieldset {
		composes: ds-fieldset from "@digdir/designsystemet-css";

		& > legend {
			padding: 0;
		}

		/* Reset designsystemet */
		& > legend + p {
			color: inherit;
			margin: 0;
		}

		/* Mark <legend> with Required if all inputs inside are required */
		&:has(:required, [aria-required="true"]):not(
				:has(:optional, [aria-required="false"])
			) {
			& > legend::after {
				content: var(--mtds-text-required);
				background: var(--mtds-color-bekk);
				border-radius: var(--ds-border-radius-sm);
				color: var(--mtds-fjord);
				font-size: .75em;
				font-weight: normal;
				line-height: var(--ds-line-height-sm);
				margin-inline-start: var(--ds-size-2);
				padding: var(--ds-size-1) var(--ds-size-2);
			}
			& label::after {
				content: none;
			}
		}

		/**
		 * Child added event inspired by:
		 * https://davidwalsh.name/detect-node-insertion
		 */
		& > [class*="validation"] {
			animation: fieldsetValidationAdded 100ms; /* Longer animation time than .field to ensure correct validation shows */
		}
	}
}

@keyframes fieldsetValidationAdded {
	from {
		scale: 1;
	}
}
